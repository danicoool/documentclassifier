<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>DocumentClassifier: src/documentclassifier/Document.java Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>src/documentclassifier/Document.java</h1><a href="Document_8java.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a><a class="code" href="namespacedocumentclassifier.html">00002</a> <span class="keyword">package </span>documentclassifier;
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="keyword">import</span> java.io.BufferedReader;
<a name="l00005"></a>00005 <span class="keyword">import</span> java.io.File;
<a name="l00006"></a>00006 <span class="keyword">import</span> java.io.FileReader;
<a name="l00007"></a>00007 <span class="keyword">import</span> java.lang.reflect.Method;
<a name="l00008"></a>00008 <span class="keyword">import</span> java.util.Collections;
<a name="l00009"></a>00009 <span class="keyword">import</span> java.util.HashMap;
<a name="l00010"></a>00010 <span class="keyword">import</span> java.util.HashSet;
<a name="l00011"></a>00011 <span class="keyword">import</span> java.util.Map;
<a name="l00012"></a>00012 <span class="keyword">import</span> java.util.Set;
<a name="l00013"></a>00013 <span class="keyword">import</span> java.util.StringTokenizer;
<a name="l00014"></a>00014 <span class="keyword">import</span> org.tartarus.snowball.SnowballProgram;
<a name="l00015"></a>00015 
<a name="l00023"></a><a class="code" href="classdocumentclassifier_1_1Document.html">00023</a> <span class="keyword">class </span><a class="code" href="classdocumentclassifier_1_1Document.html">Document</a> {
<a name="l00024"></a>00024     
<a name="l00025"></a><a class="code" href="classdocumentclassifier_1_1Document.html#ac86d20c6077dcc0ff7587c1de887d48">00025</a>     <span class="keyword">private</span> String <a class="code" href="classdocumentclassifier_1_1Document.html#ac86d20c6077dcc0ff7587c1de887d48">title</a>,<a class="code" href="classdocumentclassifier_1_1Document.html#8e6ccd9fa87b1498a75d131648ec9a7d">text</a>,<a class="code" href="classdocumentclassifier_1_1Document.html#a91645f7ebc764cfe9c56a87e8c5106b">path</a>;
<a name="l00031"></a><a class="code" href="classdocumentclassifier_1_1Document.html#5b4011a6559df6366e3fdab74d3e9092">00031</a>     <span class="keyword">private</span> Set&lt;String&gt; <a class="code" href="classdocumentclassifier_1_1Document.html#5b4011a6559df6366e3fdab74d3e9092">categories</a>;
<a name="l00036"></a><a class="code" href="classdocumentclassifier_1_1Document.html#13f8c20dfb731c20f21b5ad0bdd4de73">00036</a>     <span class="keyword">private</span> Map&lt;String,Double&gt; <a class="code" href="classdocumentclassifier_1_1Document.html#13f8c20dfb731c20f21b5ad0bdd4de73">histogram</a>;
<a name="l00037"></a>00037     
<a name="l00049"></a><a class="code" href="classdocumentclassifier_1_1Document.html#d3366b961a018d41c75c0c1409681c78">00049</a>     <span class="keyword">public</span> <a class="code" href="classdocumentclassifier_1_1Document.html#d3366b961a018d41c75c0c1409681c78">Document</a>(String <a class="code" href="classdocumentclassifier_1_1Document.html#ac86d20c6077dcc0ff7587c1de887d48">title</a>, String <a class="code" href="classdocumentclassifier_1_1Document.html#8e6ccd9fa87b1498a75d131648ec9a7d">text</a>, String initialCategory, String <a class="code" href="classdocumentclassifier_1_1Document.html#a91645f7ebc764cfe9c56a87e8c5106b">path</a>) {
<a name="l00050"></a>00050         <span class="keywordflow">try</span> {
<a name="l00051"></a>00051             <span class="keyword">this</span>.title = title;
<a name="l00052"></a>00052             <span class="keyword">this</span>.text = text;
<a name="l00053"></a>00053             <span class="keyword">this</span>.categories=<span class="keyword">new</span> HashSet&lt;String&gt;();
<a name="l00054"></a>00054             <a class="code" href="classdocumentclassifier_1_1Document.html#5b4011a6559df6366e3fdab74d3e9092">categories</a>.add(initialCategory);
<a name="l00055"></a>00055             <span class="keyword">this</span>.path = path;
<a name="l00066"></a>00066             <span class="keyword">this</span>.histogram = <a class="code" href="classdocumentclassifier_1_1Document.html#693bbcfb89744dcce243b2123c5c6198">createHistogram</a>();
<a name="l00067"></a>00067         } <span class="keywordflow">catch</span> (Exception ex) {
<a name="l00068"></a>00068             <a class="code" href="classdocumentclassifier_1_1DocumentClassifierView.html">DocumentClassifierView</a>.showErrorMessage(ex.toString());
<a name="l00069"></a>00069         }
<a name="l00070"></a>00070     }
<a name="l00071"></a>00071     
<a name="l00082"></a><a class="code" href="classdocumentclassifier_1_1Document.html#b0ace68f897d7967f6749387328cb368">00082</a>     <span class="keyword">public</span> <a class="code" href="classdocumentclassifier_1_1Document.html#d3366b961a018d41c75c0c1409681c78">Document</a>(String <a class="code" href="classdocumentclassifier_1_1Document.html#ac86d20c6077dcc0ff7587c1de887d48">title</a>, String <a class="code" href="classdocumentclassifier_1_1Document.html#8e6ccd9fa87b1498a75d131648ec9a7d">text</a>, String <a class="code" href="classdocumentclassifier_1_1Document.html#a91645f7ebc764cfe9c56a87e8c5106b">path</a>) {
<a name="l00083"></a>00083         <span class="keyword">this</span>(title,text,null,path);
<a name="l00084"></a>00084     }
<a name="l00085"></a>00085     
<a name="l00093"></a><a class="code" href="classdocumentclassifier_1_1Document.html#8c925e57594f3514beb008026aa6b2d2">00093</a>     <span class="keyword">public</span> <a class="code" href="classdocumentclassifier_1_1Document.html#d3366b961a018d41c75c0c1409681c78">Document</a>(String query) {
<a name="l00094"></a>00094         <span class="keyword">this</span>(query,<span class="stringliteral">""</span>,null);
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096     
<a name="l00106"></a><a class="code" href="classdocumentclassifier_1_1Document.html#693bbcfb89744dcce243b2123c5c6198">00106</a>     <span class="keyword">private</span> Map&lt;String, Double&gt; <a class="code" href="classdocumentclassifier_1_1Document.html#693bbcfb89744dcce243b2123c5c6198">createHistogram</a>() throws Exception {
<a name="l00107"></a>00107         
<a name="l00108"></a>00108         <a class="code" href="classdocumentclassifier_1_1DocumentClassifierApp.html">DocumentClassifierApp</a> application=<a class="code" href="classdocumentclassifier_1_1DocumentClassifierApp.html">DocumentClassifierApp</a>.getApplication();
<a name="l00109"></a>00109         <span class="keywordtype">boolean</span> isStemming=application.<a class="code" href="classdocumentclassifier_1_1DocumentClassifierApp.html#ec2dcf16436a4391025e48a290e49de7">isStemming</a>(<span class="keyword">false</span>);
<a name="l00110"></a>00110         <span class="keywordtype">boolean</span> isRemovalStopWords=application.<a class="code" href="classdocumentclassifier_1_1DocumentClassifierApp.html#c32b94f0e104db10b4a1b47718c03e11">isRemovalStopWords</a>(<span class="keyword">false</span>);
<a name="l00111"></a>00111         
<a name="l00117"></a>00117         Class stemClass = Class.forName(application.<a class="code" href="classdocumentclassifier_1_1DocumentClassifierApp.html#8e70afbf45782d7500d95425b4bf12fe">getStemmer</a>(<span class="keyword">false</span>));
<a name="l00118"></a>00118         SnowballProgram stemmer = (SnowballProgram) stemClass.newInstance();
<a name="l00119"></a>00119         @SuppressWarnings(<span class="stringliteral">"unchecked"</span>)
<a name="l00120"></a>00120         Method stemMethod = stemClass.getMethod(<span class="stringliteral">"stem"</span>, <span class="keyword">new</span> Class[0]);
<a name="l00121"></a>00121         
<a name="l00122"></a>00122         Object[] emptyArgs = <span class="keyword">new</span> Object[0];
<a name="l00123"></a>00123         String specialCharacters = <span class="stringliteral">" \t\n\r\f,;.:!'\"()?[]=-@"</span>;
<a name="l00124"></a>00124         
<a name="l00125"></a>00125         Map&lt;String, Double&gt; documentHistogram = <span class="keyword">new</span> HashMap&lt;String, Double&gt;();
<a name="l00126"></a>00126         String currentToken;
<a name="l00127"></a>00127         Double frequency;
<a name="l00128"></a>00128         <span class="keywordtype">int</span> weight;
<a name="l00129"></a>00129         String row;
<a name="l00130"></a>00130         
<a name="l00134"></a>00134         Set&lt;String&gt; stopWordsList = <span class="keyword">new</span> HashSet&lt;String&gt;();
<a name="l00135"></a>00135         BufferedReader stopWordsBR;
<a name="l00136"></a>00136         File stopWordsListFile=<span class="keyword">new</span> File(<a class="code" href="classdocumentclassifier_1_1DocumentClassifierApp.html">DocumentClassifierApp</a>.getApplication().getStopWordsList(<span class="keyword">false</span>));
<a name="l00137"></a>00137         String[] fields;
<a name="l00138"></a>00138         <span class="keywordflow">if</span>(isRemovalStopWords) {
<a name="l00143"></a>00143             stopWordsBR = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(stopWordsListFile));
<a name="l00144"></a>00144             <span class="keywordflow">while</span> ((row = stopWordsBR.readLine()) != null) {
<a name="l00145"></a>00145                 <span class="keywordflow">if</span> (!row.isEmpty()) {
<a name="l00146"></a>00146                     fields = row.split(<span class="stringliteral">"|"</span>);
<a name="l00147"></a>00147                     <span class="keywordflow">if</span> (!fields[0].startsWith(<span class="stringliteral">" "</span>)) {
<a name="l00148"></a>00148                         stopWordsList.add(fields[0].trim());
<a name="l00149"></a>00149                     }
<a name="l00150"></a>00150                 }
<a name="l00151"></a>00151             }
<a name="l00152"></a>00152             stopWordsBR.close();
<a name="l00153"></a>00153         }
<a name="l00154"></a>00154         
<a name="l00161"></a>00161         String[] titleText = <span class="keyword">new</span> String[2];
<a name="l00162"></a>00162         titleText[0] = <a class="code" href="classdocumentclassifier_1_1Document.html#ac86d20c6077dcc0ff7587c1de887d48">title</a>;
<a name="l00163"></a>00163         titleText[1] = <a class="code" href="classdocumentclassifier_1_1Document.html#8e6ccd9fa87b1498a75d131648ec9a7d">text</a>;
<a name="l00164"></a>00164         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= 1; j++) {
<a name="l00165"></a>00165             <span class="keywordflow">if</span> (j == 0) {
<a name="l00171"></a>00171                 weight = 2;
<a name="l00172"></a>00172             } <span class="keywordflow">else</span> {
<a name="l00173"></a>00173                 weight = 1;
<a name="l00174"></a>00174             }
<a name="l00175"></a>00175             titleText[j] = titleText[j].toLowerCase();
<a name="l00176"></a>00176             StringTokenizer ST = <span class="keyword">new</span> StringTokenizer(titleText[j], specialCharacters);
<a name="l00177"></a>00177             <span class="keywordflow">while</span> (ST.hasMoreTokens()) {
<a name="l00178"></a>00178                 currentToken = ST.nextToken();
<a name="l00186"></a>00186                 <span class="keywordflow">if</span> (!stopWordsList.contains(currentToken) &amp;&amp; !currentToken.matches(<span class="stringliteral">"\\d+"</span>)) {
<a name="l00187"></a>00187                     
<a name="l00188"></a>00188                     <span class="keywordflow">if</span>(isStemming) {
<a name="l00193"></a>00193                         stemmer.setCurrent(currentToken);
<a name="l00194"></a>00194                         stemMethod.invoke(stemmer, emptyArgs);
<a name="l00195"></a>00195                         currentToken = stemmer.getCurrent();
<a name="l00196"></a>00196                     }
<a name="l00202"></a>00202                     frequency = documentHistogram.get(currentToken);
<a name="l00203"></a>00203                     <span class="keywordflow">if</span> (frequency == null) {
<a name="l00204"></a>00204                         frequency = 0.0;
<a name="l00205"></a>00205                     }
<a name="l00206"></a>00206                     documentHistogram.put(currentToken, frequency + weight);
<a name="l00207"></a>00207                 }
<a name="l00208"></a>00208             }
<a name="l00209"></a>00209         }
<a name="l00210"></a>00210         
<a name="l00215"></a>00215         <span class="keywordtype">double</span> normalizationFactor = 0;
<a name="l00216"></a>00216         <span class="keywordflow">for</span> (<span class="keywordtype">double</span> I : documentHistogram.values()) {
<a name="l00217"></a>00217             <span class="comment">//Calculation of the document's length after pre-processing</span>
<a name="l00218"></a>00218             normalizationFactor += I;
<a name="l00219"></a>00219         }
<a name="l00220"></a>00220         <span class="comment">//Normalization of frequencies (from absolute to relative)</span>
<a name="l00221"></a>00221         <span class="keywordflow">for</span> (String Token : documentHistogram.keySet()) {
<a name="l00222"></a>00222             documentHistogram.put(Token, documentHistogram.get(Token) / normalizationFactor);
<a name="l00223"></a>00223         }
<a name="l00228"></a>00228         <span class="keywordflow">return</span> Collections.unmodifiableMap(documentHistogram);
<a name="l00229"></a>00229     }
<a name="l00230"></a>00230     
<a name="l00236"></a><a class="code" href="classdocumentclassifier_1_1Document.html#4c3596f5b6e67e7e36d7341390f345ac">00236</a>     <span class="keyword">public</span> Map&lt;String, Double&gt; <a class="code" href="classdocumentclassifier_1_1Document.html#4c3596f5b6e67e7e36d7341390f345ac">getHistogram</a>() {
<a name="l00237"></a>00237         <span class="keywordflow">return</span> <a class="code" href="classdocumentclassifier_1_1Document.html#13f8c20dfb731c20f21b5ad0bdd4de73">histogram</a>;
<a name="l00238"></a>00238     }
<a name="l00239"></a>00239     
<a name="l00245"></a><a class="code" href="classdocumentclassifier_1_1Document.html#6b7b197d104d51846e5db366640ae6a2">00245</a>     <span class="keyword">public</span> Set&lt;String&gt; <a class="code" href="classdocumentclassifier_1_1Document.html#6b7b197d104d51846e5db366640ae6a2">getCategories</a>() {
<a name="l00246"></a>00246         <span class="keywordflow">return</span> <a class="code" href="classdocumentclassifier_1_1Document.html#5b4011a6559df6366e3fdab74d3e9092">categories</a>;
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248     
<a name="l00254"></a><a class="code" href="classdocumentclassifier_1_1Document.html#2d66936707132dd1ddd9a9ba82173251">00254</a>     <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classdocumentclassifier_1_1Document.html#2d66936707132dd1ddd9a9ba82173251">addCategory</a>(String category) {
<a name="l00255"></a>00255         <a class="code" href="classdocumentclassifier_1_1Document.html#5b4011a6559df6366e3fdab74d3e9092">categories</a>.add(category);
<a name="l00256"></a>00256     }
<a name="l00257"></a>00257     
<a name="l00265"></a><a class="code" href="classdocumentclassifier_1_1Document.html#7fc04df41f5aaf44cadc579f8c216a40">00265</a>     <span class="keyword">public</span> String <a class="code" href="classdocumentclassifier_1_1Document.html#7fc04df41f5aaf44cadc579f8c216a40">getPath</a>() {
<a name="l00266"></a>00266         <span class="keywordflow">return</span> <a class="code" href="classdocumentclassifier_1_1Document.html#a91645f7ebc764cfe9c56a87e8c5106b">path</a>;
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268     
<a name="l00274"></a><a class="code" href="classdocumentclassifier_1_1Document.html#65e173ed014078689f27506c2c03dd54">00274</a>     <span class="keyword">public</span> String <a class="code" href="classdocumentclassifier_1_1Document.html#65e173ed014078689f27506c2c03dd54">getText</a>() {
<a name="l00275"></a>00275         <span class="keywordflow">return</span> <a class="code" href="classdocumentclassifier_1_1Document.html#8e6ccd9fa87b1498a75d131648ec9a7d">text</a>;
<a name="l00276"></a>00276     }
<a name="l00277"></a>00277     
<a name="l00283"></a><a class="code" href="classdocumentclassifier_1_1Document.html#d672dd5adf6b90daf2037acbaea20e50">00283</a>     <span class="keyword">public</span> String <a class="code" href="classdocumentclassifier_1_1Document.html#d672dd5adf6b90daf2037acbaea20e50">getTitle</a>() {
<a name="l00284"></a>00284         <span class="keywordflow">return</span> <a class="code" href="classdocumentclassifier_1_1Document.html#ac86d20c6077dcc0ff7587c1de887d48">title</a>;
<a name="l00285"></a>00285     }
<a name="l00286"></a>00286     
<a name="l00294"></a>00294     @Override
<a name="l00295"></a><a class="code" href="classdocumentclassifier_1_1Document.html#ddb19fe6276b8b63413331865b0a1dd2">00295</a>     <span class="keyword">public</span> <span class="keywordtype">boolean</span> <a class="code" href="classdocumentclassifier_1_1Document.html#ddb19fe6276b8b63413331865b0a1dd2">equals</a>(Object obj) {
<a name="l00296"></a>00296         <span class="keywordflow">if</span> (obj == null) {
<a name="l00297"></a>00297             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00298"></a>00298         }
<a name="l00299"></a>00299         <span class="keywordflow">if</span> (getClass() != obj.getClass()) {
<a name="l00300"></a>00300             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00301"></a>00301         }
<a name="l00302"></a>00302         <span class="keyword">final</span> <a class="code" href="classdocumentclassifier_1_1Document.html">Document</a> other = (<a class="code" href="classdocumentclassifier_1_1Document.html">Document</a>) obj;
<a name="l00303"></a>00303         <span class="keywordflow">if</span> (<span class="keyword">this</span>.<a class="code" href="classdocumentclassifier_1_1Document.html#ac86d20c6077dcc0ff7587c1de887d48">title</a> != other.<a class="code" href="classdocumentclassifier_1_1Document.html#ac86d20c6077dcc0ff7587c1de887d48">title</a> &amp;&amp; (<span class="keyword">this</span>.title == null || !<span class="keyword">this</span>.title.equals(other.<a class="code" href="classdocumentclassifier_1_1Document.html#ac86d20c6077dcc0ff7587c1de887d48">title</a>))) {
<a name="l00304"></a>00304             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00305"></a>00305         }
<a name="l00306"></a>00306         <span class="keywordflow">if</span> (<span class="keyword">this</span>.<a class="code" href="classdocumentclassifier_1_1Document.html#8e6ccd9fa87b1498a75d131648ec9a7d">text</a> != other.<a class="code" href="classdocumentclassifier_1_1Document.html#8e6ccd9fa87b1498a75d131648ec9a7d">text</a> &amp;&amp; (<span class="keyword">this</span>.text == null || !<span class="keyword">this</span>.text.equals(other.<a class="code" href="classdocumentclassifier_1_1Document.html#8e6ccd9fa87b1498a75d131648ec9a7d">text</a>))) {
<a name="l00307"></a>00307             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00308"></a>00308         }
<a name="l00309"></a>00309         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311 
<a name="l00312"></a>00312     @Override
<a name="l00313"></a><a class="code" href="classdocumentclassifier_1_1Document.html#4739e991b571946580429574c4181d91">00313</a>     <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classdocumentclassifier_1_1Document.html#4739e991b571946580429574c4181d91">hashCode</a>() {
<a name="l00314"></a>00314         <span class="keywordtype">int</span> hash = 3;
<a name="l00315"></a>00315         hash = 71 * hash + (<span class="keyword">this</span>.title != null ? <span class="keyword">this</span>.title.hashCode() : 0);
<a name="l00316"></a>00316         hash = 71 * hash + (<span class="keyword">this</span>.text != null ? <span class="keyword">this</span>.text.hashCode() : 0);
<a name="l00317"></a>00317         <span class="keywordflow">return</span> hash;
<a name="l00318"></a>00318     }
<a name="l00319"></a>00319     
<a name="l00320"></a>00320 }
</pre></div><hr size="1"><address style="text-align: right;"><small>Generated on Thu Oct 30 12:48:10 2008 for DocumentClassifier by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
